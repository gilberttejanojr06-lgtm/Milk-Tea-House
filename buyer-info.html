<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buyer Information - Dagupan Milk Tea House</title>
  <style>
    :root {
      --primary: #6366f1;
      --secondary: #8b5cf6;
      --accent: #10b981;
      --text-dark: #333;
    }

    * { box-sizing: border-box; font-family: "Poppins", sans-serif; margin: 0; padding: 0; }

    body {
      background: #f3f4f6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      color: var(--text-dark);
    }

    header {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      padding: 15px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    }

    header h1 { font-size: 20px; }

    nav a {
      color: white;
      text-decoration: none;
      margin-left: 20px;
      font-weight: 500;
      transition: 0.3s;
    }

    nav a:hover { text-decoration: underline; }

    .buyer-container {
      background: white;
      width: 90%;
      max-width: 480px;
      margin: 50px auto;
      padding: 25px 30px;
      border-radius: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .buyer-container h2 {
      text-align: center;
      color: var(--primary);
      margin-bottom: 20px;
    }

    label { display: block; font-weight: 600; margin-top: 10px; color: #555; }
    input, select {
      width: 100%;
      padding: 7px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #f9fafb;
      margin-top: 5px;
      font-size: 12px;
    }
    input:focus, select:focus { outline: 2px solid var(--primary); background: #fff; }

    #buyerBarangay { font-size: 11.5px; padding: 5px 6px; max-height: 80px; overflow-y: auto; }
    #buyerBarangay option { font-size: 11.5px; padding: 3px 5px; }

    .btn-group { margin-top: 25px; display: flex; gap: 10px; justify-content: center; }
    .btn { flex: 1; padding: 10px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .save-btn { background: var(--accent); color: white; }
    .save-btn:hover { background: #059669; }
    .back-btn { background: #6366f1; color: white; }
    .back-btn:hover { background: #4f46e5; }

    footer { background: var(--primary); color: white; text-align: center; padding: 12px; margin-top: auto; }
  </style>

  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>

  <header>
    <h1>Dagupan Milk Tea House</h1>
    <nav>
      <a href="home.html">Home</a>
      <a href="profile.html">Profile</a>
      <a href="index.html">Logout</a>
    </nav>
  </header>

  <div class="buyer-container">
    <h2><i class="fas fa-user-tag"></i> Buyer Information</h2>

    <form id="buyerForm">
      <label>Full Name</label>
      <input type="text" id="buyerName" placeholder="Enter full name" required>

      <label>Contact Number</label>
      <input type="text" id="buyerContact" placeholder="Enter contact number" required>

      <label>Province</label>
      <input type="text" id="buyerProvince" value="Apayao" readonly>

      <label>Municipality / City</label>
      <select id="buyerCity" required>
        <option value="">Select Municipality / City</option>
        <option value="Calanasan">Calanasan</option>
        <option value="Conner">Conner</option>
        <option value="Flora">Flora</option>
        <option value="Kabugao">Kabugao</option>
        <option value="Luna">Luna</option>
        <option value="Pudtol">Pudtol</option>
        <option value="Santa Marcela">Santa Marcela</option>
      </select>

      <label>Barangay</label>
      <select id="buyerBarangay" required>
        <option value="">Select Barangay</option>
      </select>

      <label>Street Address</label>
      <input type="text" id="buyerStreet" placeholder="House No. / Street" required>

      <label>Postal Code</label>
      <input type="text" id="buyerPostal" placeholder="Enter postal code" readonly required>

      <div class="btn-group">
        <button type="button" class="btn back-btn" onclick="goBack()">
          <i class="fas fa-arrow-left"></i> Back
        </button>
        <button type="submit" class="btn save-btn">
          <i class="fas fa-save"></i> Save Info
        </button>
      </div>
    </form>
  </div>

  <footer>
    © 2025 Dagupan Milk Tea House. All rights reserved.
  </footer>

  <script>
    // Clear buyer info if first-time sign up
    if (!localStorage.getItem("buyerInfo")) {
      localStorage.removeItem("buyerInfo");
    }

    const barangays = {
      Calanasan: ["Butao","Cadaclan","Don Roque Ablan Sr.","Eleazar","Eva Puzon","Kabugawan","Langnao","Macalico","Naguilian","Namaltugan","Problacion","Sabangan","Santa Elena","Santa Filomena","Tanglagan","Tubang","Tubongan"],
      Conner: ["Malama","Paddaoan","Karikitan","Ripang","Bagalay","Buluan"],
      Flora: ["Malayugan","Anninipan","Malubibit Norte","Balluyan","Malubibit Sur"],
      Kabugao: ["Luttuacan","Bulu","Maragat","Dagara","Nagba","Poblacion"],
      Luna: ["Capanikian","Calabigan","San Isidro Sur","San Isidro Norte","San Gregorio","Bacsay"],
      Pudtol: ["Aurora","Lenneng","Mataguisi","Amado","Cabaruan","Malibang"],
      "Santa Marcela": ["Dibagat","Binalan","Marcela Proper","Buneg","Emilia","Imelda"]
    };

    const postalCodes = {
      Calanasan: "3810",
      Conner: "3807",
      Flora: "3813",
      Kabugao: "3809",
      Luna: "3814",
      Pudtol: "3812",
      "Santa Marcela": "3811"
    };

    const citySelect = document.getElementById("buyerCity");
    const barangaySelect = document.getElementById("buyerBarangay");
    const postalInput = document.getElementById("buyerPostal");

    // Populate barangays and postal code dynamically
    citySelect.addEventListener("change", function() {
      const selectedCity = this.value;
      barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
      postalInput.value = "";

      if (barangays[selectedCity]) {
        barangays[selectedCity].forEach(bar => {
          const option = document.createElement("option");
          option.value = bar;
          option.textContent = bar;
          barangaySelect.appendChild(option);
        });
      }

      if (postalCodes[selectedCity]) {
        postalInput.value = postalCodes[selectedCity];
      }
    });

    // Load existing data if available
    const buyerData = JSON.parse(localStorage.getItem("buyerInfo")) || {};
    if (buyerData.name) {
      document.getElementById("buyerName").value = buyerData.name;
      document.getElementById("buyerContact").value = buyerData.contact;
      document.getElementById("buyerCity").value = buyerData.city;
      document.getElementById("buyerStreet").value = buyerData.street;
      postalInput.value = buyerData.postal || "";

      if (buyerData.city && barangays[buyerData.city]) {
        barangays[buyerData.city].forEach(bar => {
          const option = document.createElement("option");
          option.value = bar;
          option.textContent = bar;
          barangaySelect.appendChild(option);
        });
        barangaySelect.value = buyerData.barangay || "";
      }
    }

    // Save buyer info
    document.getElementById("buyerForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const buyerInfo = {
        name: document.getElementById("buyerName").value.trim(),
        contact: document.getElementById("buyerContact").value.trim(),
        province: document.getElementById("buyerProvince").value,
        city: document.getElementById("buyerCity").value,
        barangay: document.getElementById("buyerBarangay").value,
        street: document.getElementById("buyerStreet").value.trim(),
        postal: document.getElementById("buyerPostal").value.trim()
      };
      localStorage.setItem("buyerInfo", JSON.stringify(buyerInfo));
      alert("✅ Buyer information saved successfully!");
      window.location.href = "profile.html";
    });

    function goBack() {
      window.location.href = "profile.html";
    }
  </script>

</body>
</html>
